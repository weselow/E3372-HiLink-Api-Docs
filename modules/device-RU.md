# Модуль Device API

## Обзор

Модуль Device API предоставляет доступ к основной информации об устройстве и операциям управления. Это включает идентификацию устройства, детали прошивки и функции управления питанием.

## Содержание

- [Информация об устройстве](#информация-об-устройстве)
- [Управление устройством](#управление-устройством)
- [Информация о версии](#информация-о-версии)
- [Форматы ответов](#форматы-ответов)
- [Обработка ошибок](#обработка-ошибок)

## Информация об устройстве

### Получение основной информации об устройстве

Получает исчерпывающие детали идентификации и конфигурации устройства.

**Конечная точка**: `GET /api/device/information`

**Запрос**: Отсутствует

**Ответ**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<response>
    <DeviceName>E3372</DeviceName>
    <SerialNumber>G4PDM15709004440</SerialNumber>
    <Imei>861821030014452</Imei>
    <Imsi>26001012345678</Imsi>
    <Iccid>8991101200003204510</Iccid>
    <Msisdn></Msisdn>
    <HardwareVersion>CL1E3372SM</HardwareVersion>
    <SoftwareVersion>21.329.62.00.161</SoftwareVersion>
    <WebUIVersion>17.100.15.02.161</WebUIVersion>
    <MacAddress1>0C:96:BF:89:53:EA</MacAddress1>
    <MacAddress2></MacAddress2>
    <ProductFamily>LTE</ProductFamily>
    <Classify>hilink</Classify>
    <supportmode>LTE|WCDMA|GSM</supportmode>
    <workmode>LTE</workmode>
</response>
```

#### Поля ответа

| Поле | Описание | Пример |
|------|----------|--------|
| `DeviceName` | Название модели | E3372 |
| `SerialNumber` | Серийный номер устройства | G4PDM15709004440 |
| `Imei` | Международный идентификатор мобильного оборудования | 861821030014452 |
| `Imsi` | Международный идентификатор мобильного абонента | 26001012345678 |
| `Iccid` | Идентификатор интегральной схемы карты | 8991101200003204510 |
| `Msisdn` | ISDN номер мобильной станции (номер телефона) | |
| `HardwareVersion` | Версия аппаратного обеспечения | CL1E3372SM |
| `SoftwareVersion` | Версия прошивки | 21.329.62.00.161 |
| `WebUIVersion` | Версия веб-интерфейса | 17.100.15.02.161 |
| `MacAddress1` | Основной MAC-адрес | 0C:96:BF:89:53:EA |
| `MacAddress2` | Вторичный MAC-адрес (если доступен) | |
| `ProductFamily` | Семейство технологий | LTE |
| `Classify` | Классификация устройства | hilink |
| `supportmode` | Поддерживаемые сетевые режимы | LTE\|WCDMA\|GSM |
| `workmode` | Текущий режим работы | LTE |

## Управление устройством

### Перезагрузка устройства

Выполняет программную перезагрузку устройства.

**Конечная точка**: `POST /api/device/control`

**Запрос**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<request>
    <Control>1</Control>
</request>
```

**Ответ**: `OK`

### Выключение устройства

Выключает устройство (если поддерживается аппаратно).

**Конечная точка**: `POST /api/device/control`

**Запрос**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<request>
    <Control>4</Control>
</request>
```

**Ответ**: `OK`

#### Значения управления

| Значение | Действие | Описание |
|----------|----------|----------|
| `1` | Перезагрузка | Программная перезагрузка |
| `4` | Выключение | Отключение питания (зависит от аппаратного обеспечения) |

**Примечание**: Функция выключения может быть недоступна на всех моделях устройств.

## Информация о версии

### Проверка новой версии

Запрашивает доступные обновления прошивки.

**Конечная точка**: `GET /api/device/autorun-version`

**Запрос**: Отсутствует

**Ответ**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<response>
    <Version>11.0.2.1(H192SP2C1025)</Version>
</response>
```

#### Поля ответа

| Поле | Описание | Пример |
|------|----------|--------|
| `Version` | Текущая или доступная версия | 11.0.2.1(H192SP2C1025) |

## Примеры использования

### Базовый запрос информации об устройстве

```bash
curl -X GET http://192.168.8.1/api/device/information
```

### Перезагрузка устройства

```bash
curl -X POST http://192.168.8.1/api/device/control \
     -H "Content-Type: application/xml" \
     -d "<?xml version=\"1.0\" encoding=\"UTF-8\"?><request><Control>1</Control></request>"
```

### Проверка версии прошивки

```bash
curl -X GET http://192.168.8.1/api/device/autorun-version
```

## Обработка ошибок

### Распространенные коды ошибок

- **100004**: Система занята (во время перезагрузки/выключения)
- **100005**: Неизвестная ошибка
- **100006**: Неверный параметр (неверное значение управления)

### Примечания по реализации

1. **Поведение перезагрузки**: Устройство будет временно недоступно во время перезагрузки
2. **Поддержка выключения**: Не все устройства поддерживают программное выключение
3. **Проверка версии**: Может потребовать интернет-соединение для запросов обновлений
4. **Кэширование информации**: Информация об устройстве обычно не изменяется часто

## Соображения интеграции

### Интеграция с ModemOpus

В ModemOpus Device API используется через:
- `HiLinkClient` для HTTP-коммуникации
- Кэширование информации об устройстве в репозиториях
- Операции перезагрузки в стратегиях смены IP
- Мониторинг здоровья через статус устройства

### Лучшие практики

1. **Кэшировать информацию об устройстве** для уменьшения API-вызовов
2. **Обрабатывать перезагрузку корректно** с соответствующими тайм-аутами
3. **Проверять параметры управления** перед отправкой запросов
4. **Отслеживать доступность устройства** после операций перезагрузки

## Связанные API

- [Monitoring API](monitoring-RU.md) - Мониторинг статуса устройства
- [Security API](security-RU.md) - Контроль доступа к устройству
- [System API](system-RU.md) - Общесистемная конфигурация