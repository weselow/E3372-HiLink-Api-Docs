# Модуль System API

## Обзор

Модуль System API управляет глобальными настройками устройства, переключателями модулей и конфигурацией языка. Он предоставляет контроль над общесистемными функциями и возможностями устройства.

## Содержание

- [Модуль Global](#модуль-global)
- [Модуль Language](#модуль-language)
- [Модуль SNTP](#модуль-sntp)
- [Модуль Host](#модуль-host)

## Модуль Global

### Получение информации о состоянии модулей

Получает статус включения/отключения различных модулей и функций устройства.

**Конечная точка**: `GET /api/global/module-switch`

**Запрос**: Отсутствует

**Ответ**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<response>
    <ussd_enabled>1</ussd_enabled>
    <bbou_enabled>1</bbou_enabled>
    <sms_enabled>1</sms_enabled>
    <sdcard_enabled>1</sdcard_enabled>
    <wifi_enabled>1</wifi_enabled>
    <statistic_enabled>1</statistic_enabled>
    <help_enabled>1</help_enabled>
    <stk_enabled>1</stk_enabled>
    <pb_enabled>1</pb_enabled>
    <dlna_enabled>0</dlna_enabled>
    <ota_enabled>1</ota_enabled>
    <wifioffload_enabled>0</wifioffload_enabled>
    <cradle_enabled>0</cradle_enabled>
    <multissid_enable>0</multissid_enable>
    <ipv6_enabled>0</ipv6_enabled>
    <monthly_volume_enabled>1</monthly_volume_enabled>
    <powersave_enabled>0</powersave_enabled>
    <sntp_enabled>1</sntp_enabled>
    <encrypt_enabled>1</encrypt_enabled>
    <dataswitch_enabled>1</dataswitch_enabled>
    <poweroff_enabled>0</poweroff_enabled>
</response>
```

#### Переключатели модулей

| Поле | Описание | Значения |
|------|----------|----------|
| `ussd_enabled` | Функциональность USSD | 0=Отключено, 1=Включено |
| `sms_enabled` | Функциональность SMS | 0=Отключено, 1=Включено |
| `wifi_enabled` | Функциональность WiFi | 0=Отключено, 1=Включено |
| `pb_enabled` | Функциональность телефонной книги | 0=Отключено, 1=Включено |
| `stk_enabled` | SIM Toolkit | 0=Отключено, 1=Включено |
| `ota_enabled` | Обновления по воздуху | 0=Отключено, 1=Включено |
| `dlna_enabled` | Медиа-обмен DLNA | 0=Отключено, 1=Включено |
| `sdcard_enabled` | Поддержка SD-карты | 0=Отключено, 1=Включено |
| `ipv6_enabled` | Поддержка IPv6 | 0=Отключено, 1=Включено |
| `encrypt_enabled` | Поддержка шифрования | 0=Отключено, 1=Включено |
| `poweroff_enabled` | Программное выключение | 0=Отключено, 1=Включено |

## Модуль Language

### Конфигурация языка

Управляет настройками языка устройства и локализацией.

**Примечание**: Конечные точки языка различаются в зависимости от версии прошивки и могут требовать специального доступа.

#### Поддерживаемые языки

Общие коды языков включают:
- `en-us` - Английский (США)
- `en-gb` - Английский (Великобритания)
- `de-de` - Немецкий
- `fr-fr` - Французский
- `es-es` - Испанский
- `it-it` - Итальянский
- `ru-ru` - Русский
- `zh-cn` - Китайский (упрощенный)
- `ja-jp` - Японский

#### Операции с языком

- **Получить текущий язык**: Получить активный язык
- **Установить язык**: Изменить язык устройства
- **Список поддерживаемых языков**: Доступные языковые опции

## Модуль SNTP

### Протокол сетевого времени

Управляет автоматической синхронизацией времени с NTP-серверами.

#### Конфигурация SNTP

Типичные настройки SNTP включают:
- **Адрес NTP-сервера**: URL/IP сервера времени
- **Интервал обновления**: Частота синхронизации
- **Настройки часового пояса**: Смещение местного времени
- **Автоматические обновления**: Включение/отключение синхронизации

#### Управление временем

- **Ручная установка времени**: Установка времени устройства вручную
- **Автоматическая синхронизация**: Обновления времени на основе NTP
- **Конфигурация часового пояса**: Настройки регионального времени

## Модуль Host

### Имя хоста устройства и сетевая идентификация

Управляет сетевой идентификацией устройства и настройками имени хоста.

#### Конфигурация хоста

- **Имя хоста устройства**: Имя для сетевой идентификации
- **Имя хоста DHCP**: Имя, транслируемое DHCP-клиентам
- **Сетевая идентичность**: Присутствие устройства в сети

## Примеры использования

### Проверка статуса модулей

```bash
curl -X GET http://192.168.8.1/api/global/module-switch
```

### Проверка доступных функций

```bash
# Разбор переключателей модулей для определения доступной функциональности
curl -s http://192.168.8.1/api/global/module-switch | grep -E "(sms_enabled|wifi_enabled|ota_enabled)"
```

## Системная конфигурация

### Доступность функций

Переключатели модулей указывают, какие функции:
- **Поддерживаются аппаратно**: Физическая возможность существует
- **Включены программно**: Функция активна в прошивке
- **Разрешены к настройке**: Могут быть изменены пользователем

### Зависимости

Некоторые модули имеют зависимости:
- **Модули WiFi**: Требуют `wifi_enabled=1`
- **Модули SMS**: Требуют `sms_enabled=1`
- **Обновления OTA**: Требуют `ota_enabled=1`

## Обработка ошибок

### Распространенные коды ошибок

- **100001**: Нет поддержки (функция недоступна)
- **100002**: Недоступно (временно недоступно)
- **100003**: Не поддерживается (аппаратное ограничение)

### Примечания по реализации

1. **Обнаружение функций**: Проверяйте переключатели модулей перед использованием функций
2. **Обработка отката**: Предоставляйте альтернативы для отключенных функций
3. **Восстановление после ошибок**: Корректно обрабатывайте неподдерживаемые операции

## Соображения интеграции

### Интеграция с ModemOpus

System API используются в ModemOpus для:
- **Обнаружение функций**: Определение доступной функциональности
- **Проверка возможностей**: Проверка операций перед выполнением
- **Системный мониторинг**: Отслеживание общесистемного статуса
- **Управление конфигурацией**: Настройки системного уровня

### Лучшие практики

1. **Обнаружение возможностей**: Проверяйте доступность функций перед использованием
2. **Корректная деградация**: Правильно обрабатывайте отсутствующие функции
3. **Проверка конфигурации**: Проверяйте настройки перед применением
4. **Системный мониторинг**: Отслеживайте здоровье и статус системы

## Связанные API

- [Device API](device-RU.md) - Управление устройством и информация
- [Security API](security-RU.md) - Настройки системной безопасности
- [Network API](network-RU.md) - Конфигурация сети